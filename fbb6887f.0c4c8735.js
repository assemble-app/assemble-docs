(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{103:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return d}));var a=n(3),i=n(7),r=(n(0),n(108)),l=n(111),c={id:"dom_events",title:"DOM events and state",sidebar_label:"DOM events and stateful content"},o={unversionedId:"dom_events",id:"dom_events",isDocsHomePage:!1,title:"DOM events and state",description:"Interacting with the DOM",source:"@site/docs/dom_events.md",slug:"/dom_events",permalink:"/docs/dom_events",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dom_events.md",version:"current",sidebar_label:"DOM events and stateful content",sidebar:"someSidebar",previous:{title:"Hello world",permalink:"/docs/hello_world"},next:{title:"Environment events",permalink:"/docs/environment_events"}},s=[{value:"Interacting with the DOM",id:"interacting-with-the-dom",children:[{value:"List of attributes",id:"list-of-attributes",children:[]}]},{value:"Changing your view&#39;s state",id:"changing-your-views-state",children:[]},{value:"Rendering Dynamic Content",id:"rendering-dynamic-content",children:[]},{value:"Putting it together",id:"putting-it-together",children:[]}],b={toc:s};function d(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"interacting-with-the-dom"},"Interacting with the DOM"),Object(r.b)("p",null,"When building your dashboard you may want to add some functionality to the UI. This is easily done by utilizing special ",Object(r.b)("inlineCode",{parentName:"p"},"assemble-")," prefixed attributes in your HTML tags."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-rust"}),'a href="#" assemble-click="i-was-clicked" assemble-value-my_param="I will be a param" { \n    "Click me!"\n}\n')),Object(r.b)("p",null,"When these events trigger, they call the ",Object(r.b)("inlineCode",{parentName:"p"},"local_event")," function on your ",Object(r.b)("inlineCode",{parentName:"p"},"View"),". This method is called with a ",Object(r.b)("inlineCode",{parentName:"p"},"msg")," and ",Object(r.b)("inlineCode",{parentName:"p"},"payload")," argument. The ",Object(r.b)("inlineCode",{parentName:"p"},"msg")," is a text string to match on. The payload is a MsgPack encoded datastructure corrosponding to the event. The payload can be build using a form or the ",Object(r.b)("inlineCode",{parentName:"p"},"assemble-value-*")," attribute."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-rust"}),'#[derive(Deserialize, Serialize)]\nstruct MyClickEvent {\n    my_param: String,\n}\n\n// ...\nimpl View for ViewHandler {\n    // ..\n\n    fn local_event(&mut self, msg: &str, payload: &[u8]) -> Result<()> {\n      match msg {\n        "i-was-clicked" => {\n          let item: MyClickEvent = deserialize?(payload);\n          // Do something\n          Ok(())\n        }\n        _ => Ok(())\n      }\n    }\n}\n')),Object(r.b)("h3",{id:"list-of-attributes"},"List of attributes"),Object(r.b)("p",null,"A list of available attributes are available here. Please refer to the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#module-bindings"}),"LiveView docs")," on their phoenix equivalent for more details (simply replace ",Object(r.b)("inlineCode",{parentName:"p"},"assemble-")," prefix with ",Object(r.b)("inlineCode",{parentName:"p"},"phx-"),")"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Binding"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Attributes"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/bindings.html#click-events"}),"Params")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-value-*"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/bindings.html#click-events"}),"Click Events")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-click"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-capture-click"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/bindings.html#focus-and-blur-events"}),"Focus/Blur Events")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-blur"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-focus"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-window-blur"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-window-focus"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/bindings.html#key-events"}),"Key Events")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-keydown"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-keyup"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-window-keydown"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-window-keyup"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-key"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/form-bindings.html"}),"Form Events")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-change"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-submit"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-feedback-for"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-disable-with"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-trigger-action"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-auto-recover"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/bindings.html#rate-limiting-events-with-debounce-and-throttle"}),"Rate Limiting")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-debounce"),", ",Object(r.b)("inlineCode",{parentName:"td"},"assemble-throttle"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("a",Object(a.a)({parentName:"td"},{href:"https://hexdocs.pm/phoenix_live_view/dom-patching.html"}),"DOM Patching")),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"assemble-update"))))),Object(r.b)("h2",{id:"changing-your-views-state"},"Changing your view's state"),Object(r.b)("p",null,"Your view must implement the ",Object(r.b)("inlineCode",{parentName:"p"},"Deserialize")," and ",Object(r.b)("inlineCode",{parentName:"p"},"Serialize")," traits from serde. After an event, your view's state is serialized using MsgPack until the next event that comes in. This allows you to create stateful apps by simply mutating your View's attributes."),Object(r.b)("p",null,"See the ",Object(r.b)("a",{href:Object(l.a)("docs/limits#data-size")},"limits")," section for additional information about this serialization."),Object(r.b)("h2",{id:"rendering-dynamic-content"},"Rendering Dynamic Content"),Object(r.b)("p",null,"Content can be built up using normal Rust programming in your render method. See ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://maud.lambda.xyz/control-structures.html"}),"maud's documentation")," about how to incorporate control structures into your app."),Object(r.b)("h2",{id:"putting-it-together"},"Putting it together"),Object(r.b)("p",null,"Combining DOM events, stateful views and dynamic content, we can create an app which updates based on a click."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-rust"}),'extern crate assemble_app;\nextern crate serde;\nextern crate maud;\nuse assemble_app::*;\nuse maud::html;\nuse serde::{Deserialize, Serialize};\nuse std::collections::{HashMap};\n\nassemble_init! {{\n    register_root_view!(ViewHandler);\n}}\n\n\n#[derive(Deserialize, Serialize)]\nstruct ViewHandler {\n    chosen_animal: String,\n}\n\n\n#[derive(Deserialize, Serialize)]\nstruct MyClickEvent {\n    animal: String,\n}\n\n\nimpl View for ViewHandler {\n  fn start(_is_connected: bool, _params: HashMap<String, String>) -> Result<Self> {\n    Ok(ViewHandler {chosen_animal: "\u2753".into()}).into()\n  }\n\n  fn render(&self) -> Result<Html> {\n    let markup = html! {\n        div class="bg-indigo-700" {\n          div class="max-w-2xl mx-auto text-center py-16 px-8" {\n            h2 class="cursor-pointer mt-4 text-3xl font-extrabold text-white" {\n              "You clicked: " (self.chosen_animal)\n            }\n            a href="#" assemble-click="i-was-clicked" assemble-value-animal="\ud83d\udc15" class="cursor-pointer mt-4 mx-6 text-2xl font-extrabold text-white" {\n              "\ud83d\udc15"\n            }\n            a href="#" assemble-click="i-was-clicked" assemble-value-animal="\ud83d\udc08" class="cursor-pointer mt-4 mx-6 text-2xl font-extrabold text-white" {\n              "\ud83d\udc08"\n            }\n          }\n\n        }\n    };\n    Ok(markup.into_string())\n  }\n  \n  \n  fn local_event(&mut self, msg: &str, payload: &[u8]) -> Result<()> {\n      match msg {\n        "i-was-clicked" => {\n          let ev: MyClickEvent = deserialize(payload)?;\n          self.chosen_animal = ev.animal;\n          Ok(())\n        }\n        _ => Ok(())\n      }\n  }\n    \n}\n')))}d.isMDXComponent=!0},108:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=i.a.createContext({}),b=function(e){var t=i.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},d=function(e){var t=b(e.components);return i.a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),d=b(n),u=a,p=d["".concat(l,".").concat(u)]||d[u]||m[u]||r;return n?i.a.createElement(p,c(c({ref:t},s),{},{components:n})):i.a.createElement(p,c({ref:t},s))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=u;var c={};for(var o in t)hasOwnProperty.call(t,o)&&(c[o]=t[o]);c.originalType=e,c.mdxType="string"==typeof e?e:a,l[1]=c;for(var s=2;s<r;s++)l[s]=n[s];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},111:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return l}));var a=n(21),i=n(113);function r(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(a.default)();return{withBaseUrl:(n,a)=>function(e,t,n,{forcePrependBaseUrl:a=!1,absolute:r=!1}={}){if(!n)return n;if(n.startsWith("#"))return n;if(Object(i.b)(n))return n;if(a)return t+n;const l=n.startsWith(t)?n:t+n.replace(/^\//,"");return r?e+l:l}(t,e,n,a)}}function l(e,t={}){const{withBaseUrl:n}=r();return n(e,t)}},113:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))}}]);